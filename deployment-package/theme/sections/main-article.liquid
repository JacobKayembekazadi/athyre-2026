{% schema %}
{
  "name": "Article",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "select",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "1",
      "options": [
        { "value": "1", "label": "Scheme 1 (Light)" },
        { "value": "2", "label": "Scheme 2 (Dark)" },
        { "value": "3", "label": "Scheme 3 (Accent)" }
      ]
    },
    {
      "type": "checkbox",
      "id": "show_featured_image",
      "label": "Show featured image",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "label": "Show author",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "label": "Show date",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_share_buttons",
      "label": "Show share buttons",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_comments",
      "label": "Show comments",
      "default": true
    },
    {
      "type": "header",
      "content": "Labels"
    },
    {
      "type": "text",
      "id": "share_label",
      "label": "Share label",
      "default": "Share"
    },
    {
      "type": "text",
      "id": "comment_form_heading",
      "label": "Comment form heading",
      "default": "Leave a Comment"
    },
    {
      "type": "text",
      "id": "comment_success",
      "label": "Comment success message",
      "default": "Your comment has been submitted and will appear once approved."
    },
    {
      "type": "text",
      "id": "comment_name_label",
      "label": "Name field label",
      "default": "Name"
    },
    {
      "type": "text",
      "id": "comment_email_label",
      "label": "Email field label",
      "default": "Email"
    },
    {
      "type": "text",
      "id": "comment_body_label",
      "label": "Comment field label",
      "default": "Comment"
    },
    {
      "type": "text",
      "id": "comment_button",
      "label": "Submit comment button",
      "default": "Post Comment"
    }
  ]
}
{% endschema %}

<article class="color-scheme-{{ section.settings.color_scheme }}">
  {%- comment -%} Hero {%- endcomment -%}
  {%- if section.settings.show_featured_image and article.image -%}
    <div class="aspect-[21/9] bg-stone-100 overflow-hidden">
      {{ article.image | image_url: width: 2000 | image_tag: class: 'w-full h-full object-cover' }}
    </div>
  {%- endif -%}

  <div class="py-16 md:py-24 px-4 md:px-8">
    <div class="max-w-3xl mx-auto">
      {%- comment -%} Header {%- endcomment -%}
      <header class="text-center mb-8 md:mb-12">
        <a href="{{ blog.url }}" class="text-[10px] uppercase tracking-widest text-stone-400 hover:text-stone-900 transition-colors mb-4 inline-block">
          &larr; {{ blog.title }}
        </a>

        <h1 class="text-2xl md:text-4xl lg:text-5xl font-light leading-tight mb-4 md:mb-6">{{ article.title }}</h1>

        <div class="flex items-center justify-center gap-4 text-sm text-stone-500">
          {%- if section.settings.show_author -%}
            <span>By {{ article.author }}</span>
          {%- endif -%}
          {%- if section.settings.show_date -%}
            <span>&bull;</span>
            <time datetime="{{ article.published_at | date: '%Y-%m-%d' }}">{{ article.published_at | date: '%B %d, %Y' }}</time>
          {%- endif -%}
        </div>

        {%- if article.tags.size > 0 -%}
          <div class="flex flex-wrap justify-center gap-2 mt-6">
            {%- for tag in article.tags -%}
              <a href="{{ blog.url }}/tagged/{{ tag | handle }}" class="text-[9px] uppercase tracking-widest text-stone-400 hover:text-stone-900 px-3 py-1 border border-stone-200 transition-colors">
                {{ tag }}
              </a>
            {%- endfor -%}
          </div>
        {%- endif -%}
      </header>

      {%- comment -%} Content {%- endcomment -%}
      <div class="prose prose-lg prose-stone max-w-none mb-12">
        {{ article.content }}
      </div>

      {%- comment -%} Share {%- endcomment -%}
      {%- if section.settings.show_share_buttons -%}
        <div class="flex items-center justify-center gap-6 py-8 border-y border-stone-100">
          <span class="text-[10px] uppercase tracking-widest font-bold text-stone-400">{{ section.settings.share_label }}</span>
          <a href="https://www.facebook.com/sharer.php?u={{ shop.url }}{{ article.url }}" target="_blank" rel="noopener" aria-label="Share on Facebook" class="text-stone-400 hover:text-stone-900 transition-colors">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg>
          </a>
          <a href="https://twitter.com/intent/tweet?text={{ article.title | url_encode }}&url={{ shop.url }}{{ article.url }}" target="_blank" rel="noopener" aria-label="Share on X" class="text-stone-400 hover:text-stone-900 transition-colors">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"/></svg>
          </a>
          <a href="mailto:?subject={{ article.title | url_encode }}&body={{ shop.url }}{{ article.url }}" aria-label="Share via email" class="text-stone-400 hover:text-stone-900 transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><path d="M22 6l-10 7L2 6"/></svg>
          </a>
        </div>
      {%- endif -%}

      {%- comment -%} Comments {%- endcomment -%}
      {%- if section.settings.show_comments and blog.comments_enabled? -%}
        <div class="mt-12" id="comments">
          <h3 class="text-xl font-medium mb-8">{{ article.comments_count }} {% if article.comments_count == 1 %}Comment{% else %}Comments{% endif %}</h3>

          {%- paginate article.comments by 20 -%}
            {%- if article.comments.size > 0 -%}
              <div class="space-y-8 mb-12">
                {%- for comment in article.comments -%}
                  <div class="p-6 bg-stone-50" id="comment-{{ comment.id }}">
                    <div class="flex items-center gap-3 mb-4">
                      <span class="font-medium">{{ comment.author }}</span>
                      <span class="text-xs text-stone-400">{{ comment.created_at | date: '%B %d, %Y' }}</span>
                    </div>
                    <div class="prose prose-sm prose-stone">{{ comment.content }}</div>
                  </div>
                {%- endfor -%}
              </div>
            {%- endif -%}
          {%- endpaginate -%}

          {%- comment -%} Comment Form {%- endcomment -%}
          {%- form 'new_comment', article -%}
            <h4 class="text-lg font-medium mb-6">{{ section.settings.comment_form_heading }}</h4>

            {%- if form.posted_successfully? -%}
              <div class="bg-green-50 border border-green-200 text-green-700 p-4 mb-6 text-sm">
                {{ section.settings.comment_success }}
              </div>
            {%- endif -%}

            {%- if form.errors -%}
              <div class="bg-red-50 border border-red-200 text-red-700 p-4 mb-6 text-sm">
                {{ form.errors | default_errors }}
              </div>
            {%- endif -%}

            <div class="grid md:grid-cols-2 gap-4 mb-4">
              <div>
                <label for="CommentAuthor" class="block text-[10px] uppercase tracking-widest font-bold text-stone-500 mb-2">{{ section.settings.comment_name_label }}</label>
                <input type="text" id="CommentAuthor" name="comment[author]" value="{{ form.author }}" required class="w-full px-4 py-3 border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900">
              </div>
              <div>
                <label for="CommentEmail" class="block text-[10px] uppercase tracking-widest font-bold text-stone-500 mb-2">{{ section.settings.comment_email_label }}</label>
                <input type="email" id="CommentEmail" name="comment[email]" value="{{ form.email }}" required class="w-full px-4 py-3 border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900">
              </div>
            </div>
            <div class="mb-4">
              <label for="CommentBody" class="block text-[10px] uppercase tracking-widest font-bold text-stone-500 mb-2">{{ section.settings.comment_body_label }}</label>
              <textarea id="CommentBody" name="comment[body]" rows="5" required class="w-full px-4 py-3 border border-stone-200 focus:outline-none focus:ring-2 focus:ring-stone-900 resize-none">{{ form.body }}</textarea>
            </div>
            <button type="submit" class="px-8 py-4 bg-stone-900 text-white text-[10px] uppercase tracking-widest font-bold hover:bg-stone-800 transition-colors">
              {{ section.settings.comment_button }}
            </button>
          {%- endform -%}
        </div>
      {%- endif -%}
    </div>
  </div>
</article>

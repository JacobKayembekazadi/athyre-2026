{% schema %}
{
  "name": "Blog Preview",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "select",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "1",
      "options": [
        {
          "value": "1",
          "label": "Scheme 1 (Light)"
        },
        {
          "value": "2",
          "label": "Scheme 2 (Dark)"
        },
        {
          "value": "3",
          "label": "Scheme 3 (Accent)"
        }
      ]
    },
    {
      "type": "text",
      "id": "label",
      "label": "Label",
      "default": "The Journal"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Words for the Journey"
    },
    {
      "type": "text",
      "id": "link_text",
      "label": "View all link text",
      "default": "Read All"
    },
    {
      "type": "blog",
      "id": "blog",
      "label": "Blog"
    },
    {
      "type": "range",
      "id": "post_count",
      "label": "Number of posts to show",
      "min": 2,
      "max": 6,
      "step": 1,
      "default": 3
    }
  ],
  "presets": [
    {
      "name": "Blog Preview"
    }
  ]
}
{% endschema %}

<section class="color-scheme-{{ section.settings.color_scheme }} py-24 px-8 max-w-7xl mx-auto border-t border-stone-100">
  <div class="flex justify-between items-end mb-12">
    <div>
      {% if section.settings.label != blank %}
        <span class="text-[10px] uppercase tracking-[0.4em] text-stone-400 font-bold block mb-4">{{ section.settings.label }}</span>
      {% endif %}
      {% if section.settings.heading != blank %}
        <h2 class="text-3xl font-light uppercase tracking-tight">{{ section.settings.heading }}</h2>
      {% endif %}
    </div>
    {% if section.settings.link_text != blank and blogs[section.settings.blog].url != blank %}
      <a href="{{ blogs[section.settings.blog].url }}" class="text-[10px] uppercase tracking-widest font-black border-b border-stone-900 pb-1 hover:opacity-60 transition-opacity">{{ section.settings.link_text }}</a>
    {% endif %}
  </div>

  {%- assign post_count = section.settings.post_count | default: 3 -%}

  <div class="grid md:grid-cols-{{ post_count | at_most: 3 }} gap-8">
    {% assign blog = blogs[section.settings.blog] %}
    {% for article in blog.articles limit: post_count %}
      <a href="{{ article.url }}" class="group block">
        <div class="aspect-[4/3] bg-stone-100 mb-6 overflow-hidden">
          {% if article.image %}
            {{ article.image | image_url: width: 600 | image_tag: class: 'w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-700', loading: 'lazy' }}
          {% else %}
            {{ 'image' | placeholder_svg_tag: 'w-full h-full object-cover grayscale opacity-50' }}
          {% endif %}
        </div>
        <span class="text-[9px] uppercase tracking-widest text-stone-400 block mb-2">{{ article.published_at | date: "%B %d, %Y" }}</span>
        <h3 class="text-xl font-serif italic group-hover:underline underline-offset-4 decoration-1">{{ article.title }}</h3>
      </a>
    {% else %}
      {% for i in (1..post_count) %}
        <div class="group block">
          <div class="aspect-[4/3] bg-stone-100 mb-6 overflow-hidden">
            {{ 'image' | placeholder_svg_tag: 'w-full h-full object-cover grayscale opacity-50' }}
          </div>
          <span class="text-[9px] uppercase tracking-widest text-stone-400 block mb-2">October 24, 2024</span>
          <h3 class="text-xl font-serif italic">Sample Article Title {{ i }}</h3>
        </div>
      {% endfor %}
    {% endfor %}
  </div>
</section>

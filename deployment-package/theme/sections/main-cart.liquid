{% schema %}
{
  "name": "Cart",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "select",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "1",
      "options": [
        { "value": "1", "label": "Scheme 1 (Light)" },
        { "value": "2", "label": "Scheme 2 (Dark)" },
        { "value": "3", "label": "Scheme 3 (Accent)" }
      ]
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "label": "Show product vendor",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enable_cart_note",
      "label": "Enable cart note",
      "default": true
    },
    {
      "type": "header",
      "content": "Labels"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Page heading",
      "default": "Your Cart"
    },
    {
      "type": "text",
      "id": "empty_text",
      "label": "Empty cart text",
      "default": "Your cart is empty"
    },
    {
      "type": "text",
      "id": "continue_shopping_label",
      "label": "Continue shopping button",
      "default": "Continue Shopping"
    },
    {
      "type": "text",
      "id": "update_button",
      "label": "Update cart button",
      "default": "Update Cart"
    },
    {
      "type": "text",
      "id": "checkout_button",
      "label": "Checkout button",
      "default": "Checkout"
    },
    {
      "type": "text",
      "id": "remove_label",
      "label": "Remove item text",
      "default": "Remove"
    }
  ]
}
{% endschema %}

<section class="color-scheme-{{ section.settings.color_scheme }} py-16 md:py-24 px-4 md:px-8 min-h-[60vh]">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-2xl md:text-3xl font-light uppercase tracking-tight text-center mb-8 md:mb-12">
      {{ section.settings.heading }}
    </h1>

    {%- if cart.item_count == 0 -%}
      <div class="text-center py-16">
        <div class="inline-block p-6 rounded-full bg-stone-100 mb-8">
          <svg class="w-12 h-12 text-stone-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <circle cx="9" cy="21" r="1"/>
            <circle cx="20" cy="21" r="1"/>
            <path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"/>
          </svg>
        </div>
        <p class="text-stone-500 mb-8">{{ section.settings.empty_text }}</p>
        <a href="{{ routes.all_products_collection_url }}" class="inline-block px-8 py-4 bg-stone-900 text-white text-[10px] uppercase tracking-widest font-bold hover:bg-stone-800 transition-colors">
          {{ section.settings.continue_shopping_label }}
        </a>
      </div>
    {%- else -%}
      <form action="{{ routes.cart_url }}" method="post">
        {%- comment -%} Cart Header {%- endcomment -%}
        <div class="border-b border-stone-100 pb-4 mb-4 hidden md:grid grid-cols-12 gap-4 text-[10px] uppercase tracking-widest font-bold text-stone-400">
          <div class="col-span-6">{{ 'cart.items.product' | t | default: 'Product' }}</div>
          <div class="col-span-2 text-center">{{ 'cart.items.price' | t | default: 'Price' }}</div>
          <div class="col-span-2 text-center">{{ 'cart.items.quantity' | t | default: 'Quantity' }}</div>
          <div class="col-span-2 text-right">{{ 'cart.items.total' | t | default: 'Total' }}</div>
        </div>

        {%- for item in cart.items -%}
          <div class="grid grid-cols-12 gap-4 py-6 border-b border-stone-100 items-center" data-cart-item="{{ item.key }}">
            {%- comment -%} Product {%- endcomment -%}
            <div class="col-span-12 md:col-span-6 flex gap-4">
              <a href="{{ item.url }}" class="w-24 h-32 bg-stone-100 flex-shrink-0 overflow-hidden">
                {%- if item.image -%}
                  {{ item.image | image_url: width: 200 | image_tag: class: 'w-full h-full object-cover' }}
                {%- endif -%}
              </a>
              <div>
                <a href="{{ item.url }}" class="font-medium hover:underline block">{{ item.product.title }}</a>
                {%- if section.settings.show_vendor and item.vendor -%}
                  <p class="text-xs text-stone-500 mt-1">{{ item.vendor }}</p>
                {%- endif -%}
                {%- if item.variant.title != 'Default Title' -%}
                  <p class="text-sm text-stone-500 mt-1">{{ item.variant.title }}</p>
                {%- endif -%}
                <button type="button" class="text-xs text-red-500 hover:text-red-700 mt-2 md:hidden" onclick="this.closest('[data-cart-item]').querySelector('[name*=updates]').value='0';this.closest('form').submit();">
                  {{ section.settings.remove_label }}
                </button>
              </div>
            </div>

            {%- comment -%} Price {%- endcomment -%}
            <div class="col-span-4 md:col-span-2 text-center">
              <span class="md:hidden text-xs text-stone-400 block mb-1">{{ 'cart.items.price' | t | default: 'Price' }}</span>
              {{ item.original_price | money }}
            </div>

            {%- comment -%} Quantity {%- endcomment -%}
            <div class="col-span-4 md:col-span-2 flex justify-center">
              <div class="flex items-center border border-stone-200">
                <button type="button" class="w-10 h-10 flex items-center justify-center hover:bg-stone-100" onclick="this.nextElementSibling.stepDown();this.closest('form').submit();" aria-label="Decrease quantity">&minus;</button>
                <input type="number" name="updates[{{ item.key }}]" value="{{ item.quantity }}" min="0" class="w-12 h-10 text-center border-x border-stone-200 text-sm" aria-label="Quantity">
                <button type="button" class="w-10 h-10 flex items-center justify-center hover:bg-stone-100" onclick="this.previousElementSibling.stepUp();this.closest('form').submit();" aria-label="Increase quantity">+</button>
              </div>
            </div>

            {%- comment -%} Total {%- endcomment -%}
            <div class="col-span-4 md:col-span-2 text-right">
              <span class="md:hidden text-xs text-stone-400 block mb-1">{{ 'cart.items.total' | t | default: 'Total' }}</span>
              <span class="font-medium">{{ item.final_line_price | money }}</span>
              <button type="button" class="text-xs text-stone-400 hover:text-red-500 block mt-2 hidden md:block" onclick="this.closest('[data-cart-item]').querySelector('[name*=updates]').value='0';this.closest('form').submit();">
                {{ section.settings.remove_label }}
              </button>
            </div>
          </div>
        {%- endfor -%}

        {%- comment -%} Cart Note {%- endcomment -%}
        {%- if section.settings.enable_cart_note -%}
          <div class="mt-8">
            <label for="CartNote" class="block text-[10px] uppercase tracking-widest font-bold text-stone-400 mb-2">
              {{ 'cart.general.note' | t | default: 'Order notes' }}
            </label>
            <textarea id="CartNote" name="note" rows="3" class="w-full p-4 border border-stone-200 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-stone-900" placeholder="{{ 'cart.general.note_placeholder' | t | default: 'Add a note to your order...' }}">{{ cart.note }}</textarea>
          </div>
        {%- endif -%}

        {%- comment -%} Summary {%- endcomment -%}
        <div class="mt-8 bg-stone-50 p-8">
          <div class="flex justify-between items-center mb-4">
            <span class="text-stone-600">{{ 'cart.general.subtotal' | t | default: 'Subtotal' }}</span>
            <span class="text-xl font-medium">{{ cart.total_price | money }}</span>
          </div>
          <p class="text-xs text-stone-500 mb-6">{{ 'cart.general.taxes_and_shipping' | t | default: 'Taxes and shipping calculated at checkout' }}</p>

          <div class="flex flex-col sm:flex-row gap-4">
            <button type="submit" name="update" class="flex-1 py-4 border border-stone-200 text-[10px] uppercase tracking-widest font-bold hover:bg-stone-100 transition-colors">
              {{ section.settings.update_button }}
            </button>
            <button type="submit" name="checkout" class="flex-1 py-4 bg-stone-900 text-white text-[10px] uppercase tracking-widest font-bold hover:bg-stone-800 transition-colors">
              {{ section.settings.checkout_button }}
            </button>
          </div>
        </div>
      </form>
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "Blog",
  "settings": [
    {
      "type": "select",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "1",
      "options": [
        {
          "value": "1",
          "label": "Scheme 1 (Light)"
        },
        {
          "value": "2",
          "label": "Scheme 2 (Dark)"
        },
        {
          "value": "3",
          "label": "Scheme 3 (Accent)"
        }
      ]
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Layout",
      "default": "grid",
      "options": [
        {
          "value": "grid",
          "label": "Grid"
        },
        {
          "value": "list",
          "label": "List"
        }
      ]
    },
    {
      "type": "range",
      "id": "posts_per_page",
      "label": "Posts per page",
      "min": 6,
      "max": 24,
      "step": 3,
      "default": 12
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "label": "Show author",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "label": "Show date",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_tags",
      "label": "Show tags filter",
      "default": true
    }
  ]
}
{% endschema %}

<section class="color-scheme-{{ section.settings.color_scheme }} py-16 md:py-24 px-4 md:px-8">
  <div class="max-w-7xl mx-auto">
    {%- comment -%} Header {%- endcomment -%}
    <header class="text-center mb-10 md:mb-16">
      <h1 class="text-2xl md:text-4xl font-light uppercase tracking-tight">{{ blog.title }}</h1>
      {%- if blog.all_tags.size > 0 and section.settings.show_tags -%}
        <nav class="mt-8 flex flex-wrap justify-center gap-4">
          <a href="{{ blog.url }}" class="text-[10px] uppercase tracking-widest {% unless current_tags %}font-bold text-stone-900{% else %}text-stone-400 hover:text-stone-900{% endunless %} transition-colors">
            All
          </a>
          {%- for tag in blog.all_tags -%}
            <a href="{{ blog.url }}/tagged/{{ tag | handle }}" class="text-[10px] uppercase tracking-widest {% if current_tags contains tag %}font-bold text-stone-900{% else %}text-stone-400 hover:text-stone-900{% endif %} transition-colors">
              {{ tag }}
            </a>
          {%- endfor -%}
        </nav>
      {%- endif -%}
    </header>

    {%- comment -%} Articles {%- endcomment -%}
    {%- paginate blog.articles by section.settings.posts_per_page -%}
      {%- if section.settings.layout == 'grid' -%}
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {%- for article in blog.articles -%}
            <article class="group">
              <a href="{{ article.url }}" class="block">
                <div class="aspect-[4/3] bg-stone-100 overflow-hidden mb-6">
                  {%- if article.image -%}
                    {{ article.image | image_url: width: 800 | image_tag: class: 'w-full h-full object-cover group-hover:scale-105 transition-transform duration-700' }}
                  {%- else -%}
                    {{ 'image' | placeholder_svg_tag: 'w-full h-full object-cover opacity-20' }}
                  {%- endif -%}
                </div>
              </a>
              
              <div class="flex flex-wrap gap-2 mb-3">
                {%- for tag in article.tags limit: 2 -%}
                  <span class="text-[9px] uppercase tracking-widest text-stone-400 font-bold">{{ tag }}</span>
                {%- endfor -%}
              </div>
              
              <h2 class="text-xl font-medium mb-3">
                <a href="{{ article.url }}" class="hover:opacity-60 transition-opacity">{{ article.title }}</a>
              </h2>
              
              {%- if article.excerpt.size > 0 -%}
                <p class="text-sm text-stone-500 line-clamp-2 mb-4">{{ article.excerpt | strip_html | truncate: 150 }}</p>
              {%- endif -%}
              
              <div class="flex items-center gap-4 text-xs text-stone-400">
                {%- if section.settings.show_author -%}
                  <span>{{ article.author }}</span>
                {%- endif -%}
                {%- if section.settings.show_date -%}
                  <time datetime="{{ article.published_at | date: '%Y-%m-%d' }}">{{ article.published_at | date: '%B %d, %Y' }}</time>
                {%- endif -%}
              </div>
            </article>
          {%- endfor -%}
        </div>
      {%- else -%}
        <div class="space-y-12">
          {%- for article in blog.articles -%}
            <article class="grid md:grid-cols-3 gap-8 group">
              <a href="{{ article.url }}" class="block">
                <div class="aspect-[4/3] bg-stone-100 overflow-hidden">
                  {%- if article.image -%}
                    {{ article.image | image_url: width: 600 | image_tag: class: 'w-full h-full object-cover group-hover:scale-105 transition-transform duration-700' }}
                  {%- endif -%}
                </div>
              </a>
              <div class="md:col-span-2 flex flex-col justify-center">
                <h2 class="text-2xl font-medium mb-4">
                  <a href="{{ article.url }}" class="hover:opacity-60 transition-opacity">{{ article.title }}</a>
                </h2>
                {%- if article.excerpt.size > 0 -%}
                  <p class="text-stone-500 mb-4">{{ article.excerpt | strip_html | truncate: 200 }}</p>
                {%- endif -%}
                <div class="flex items-center gap-4 text-xs text-stone-400">
                  {%- if section.settings.show_author -%}
                    <span>{{ article.author }}</span>
                  {%- endif -%}
                  {%- if section.settings.show_date -%}
                    <time datetime="{{ article.published_at | date: '%Y-%m-%d' }}">{{ article.published_at | date: '%B %d, %Y' }}</time>
                  {%- endif -%}
                </div>
              </div>
            </article>
          {%- endfor -%}
        </div>
      {%- endif -%}

      {%- comment -%} Pagination {%- endcomment -%}
      {%- if paginate.pages > 1 -%}
        <nav class="mt-16 flex justify-center gap-4">
          {%- if paginate.previous -%}
            <a href="{{ paginate.previous.url }}" class="px-6 py-3 border border-stone-200 text-[10px] uppercase tracking-widest font-bold hover:bg-stone-100 transition-colors">
              {{ 'general.pagination.previous' | t | default: 'Previous' }}
            </a>
          {%- endif -%}
          {%- if paginate.next -%}
            <a href="{{ paginate.next.url }}" class="px-6 py-3 bg-stone-900 text-white text-[10px] uppercase tracking-widest font-bold hover:bg-stone-800 transition-colors">
              {{ 'general.pagination.next' | t | default: 'Next' }}
            </a>
          {%- endif -%}
        </nav>
      {%- endif -%}
    {%- endpaginate -%}
  </div>
</section>

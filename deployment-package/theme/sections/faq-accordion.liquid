{% schema %}
{
  "name": "FAQ Accordion",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "select",
      "id": "color_scheme",
      "label": "Color scheme",
      "options": [
        {
          "value": "1",
          "label": "Light"
        },
        {
          "value": "2",
          "label": "Dark"
        },
        {
          "value": "3",
          "label": "Accent"
        }
      ],
      "default": "1"
    },
    {
      "type": "text",
      "id": "label",
      "label": "Label text",
      "default": "Support"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Frequently Asked Questions"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>Find answers to common questions about our products, shipping, and more.</p>"
    },
    {
      "type": "text",
      "id": "contact_heading",
      "label": "Contact CTA heading",
      "default": "Still have questions?"
    },
    {
      "type": "text",
      "id": "contact_text",
      "label": "Contact CTA text",
      "default": "Our team is here to help."
    },
    {
      "type": "text",
      "id": "contact_button_label",
      "label": "Contact button label",
      "default": "Contact Us"
    },
    {
      "type": "url",
      "id": "contact_button_link",
      "label": "Contact button link"
    }
  ],
  "blocks": [
    {
      "type": "question",
      "name": "Question",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "How long does shipping take?"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Standard shipping takes 3-5 business days. Expedited shipping is available at checkout for 1-2 business day delivery.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ Accordion",
      "blocks": [
        {
          "type": "question",
          "settings": {
            "question": "What is your return policy?",
            "answer": "<p>We accept returns within 30 days of purchase. Items must be in original condition with tags attached.</p>"
          }
        },
        {
          "type": "question",
          "settings": {
            "question": "How long does shipping take?",
            "answer": "<p>Standard shipping takes 3-5 business days. Expedited shipping is available at checkout.</p>"
          }
        },
        {
          "type": "question",
          "settings": {
            "question": "Do you offer international shipping?",
            "answer": "<p>Yes, we ship to most countries. International shipping typically takes 7-14 business days.</p>"
          }
        },
        {
          "type": "question",
          "settings": {
            "question": "How do I track my order?",
            "answer": "<p>Once your order ships, you'll receive a confirmation email with a tracking number and link.</p>"
          }
        },
        {
          "type": "question",
          "settings": {
            "question": "What payment methods do you accept?",
            "answer": "<p>We accept all major credit cards, PayPal, Apple Pay, Google Pay, and Shop Pay.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}

<div class="color-scheme-{{ section.settings.color_scheme }} py-16 md:py-24 px-4 md:px-8">
  <div class="max-w-3xl mx-auto">

    {% if section.settings.label != blank %}
      <p class="text-[10px] uppercase tracking-[0.3em] opacity-60 mb-4 text-center">{{ section.settings.label }}</p>
    {% endif %}

    {% if section.settings.heading != blank %}
      <h1 class="text-3xl md:text-5xl font-black tracking-tight uppercase text-center mb-4">{{ section.settings.heading }}</h1>
    {% endif %}

    {% if section.settings.description != blank %}
      <div class="text-sm text-center opacity-70 mb-12 max-w-xl mx-auto">{{ section.settings.description }}</div>
    {% endif %}

    {% if section.blocks.size > 0 %}
      <div class="divide-y divide-current/10" x-data="{ openIndex: null }">
        {% for block in section.blocks %}
          <div {{ block.shopify_attributes }}>
            <button
              class="w-full flex justify-between items-center py-6 text-left group"
              @click="openIndex = openIndex === {{ forloop.index }} ? null : {{ forloop.index }}"
              aria-expanded="false"
              :aria-expanded="openIndex === {{ forloop.index }}"
            >
              <span class="text-sm md:text-base font-bold uppercase tracking-wider pr-4">{{ block.settings.question }}</span>
              <span class="flex-shrink-0 transition-transform duration-300" :class="{ 'rotate-45': openIndex === {{ forloop.index }} }">
                {% render 'icon-plus', class: 'w-4 h-4' %}
              </span>
            </button>
            <div
              x-show="openIndex === {{ forloop.index }}"
              x-collapse
              x-cloak
              class="pb-6"
            >
              <div class="text-sm leading-relaxed opacity-70 max-w-2xl">
                {{ block.settings.answer }}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% endif %}

    {% if section.settings.contact_heading != blank %}
      <div class="text-center mt-16 pt-16 border-t border-current/10">
        <h3 class="text-lg font-bold uppercase tracking-wider mb-2">{{ section.settings.contact_heading }}</h3>
        {% if section.settings.contact_text != blank %}
          <p class="text-sm opacity-60 mb-6">{{ section.settings.contact_text }}</p>
        {% endif %}
        {% if section.settings.contact_button_label != blank and section.settings.contact_button_link != blank %}
          <a href="{{ section.settings.contact_button_link }}" class="inline-block border border-current px-8 py-3 text-[10px] uppercase tracking-[0.2em] font-bold hover:bg-stone-900 hover:text-white transition-colors">
            {{ section.settings.contact_button_label }}
          </a>
        {% endif %}
      </div>
    {% endif %}

  </div>
</div>

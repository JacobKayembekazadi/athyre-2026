{% schema %}
{
  "name": "Password Page",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background image"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Opening Soon"
    },
    {
      "type": "richtext",
      "id": "message",
      "label": "Message",
      "default": "<p>We're working on something special. Enter your email to be the first to know when we launch.</p>"
    },
    {
      "type": "checkbox",
      "id": "show_newsletter",
      "label": "Show newsletter signup",
      "default": true
    },
    {
      "type": "text",
      "id": "newsletter_placeholder",
      "label": "Email placeholder",
      "default": "Enter your email"
    },
    {
      "type": "text",
      "id": "newsletter_button",
      "label": "Newsletter button text",
      "default": "Notify Me"
    },
    {
      "type": "text",
      "id": "newsletter_success",
      "label": "Newsletter success message",
      "default": "Thank you! We will notify you when we launch."
    },
    {
      "type": "checkbox",
      "id": "show_social",
      "label": "Show social media links",
      "default": true
    },
    {
      "type": "header",
      "content": "Password Modal"
    },
    {
      "type": "text",
      "id": "password_link_text",
      "label": "Enter password link text",
      "default": "Enter using password"
    },
    {
      "type": "text",
      "id": "modal_heading",
      "label": "Modal heading",
      "default": "Enter Store Password"
    },
    {
      "type": "text",
      "id": "modal_placeholder",
      "label": "Password placeholder",
      "default": "Password"
    },
    {
      "type": "text",
      "id": "modal_submit",
      "label": "Submit button text",
      "default": "Enter"
    },
    {
      "type": "text",
      "id": "modal_cancel",
      "label": "Cancel button text",
      "default": "Cancel"
    }
  ]
}
{% endschema %}

{%- layout 'password' -%}

<div class="min-h-screen flex flex-col justify-center items-center text-center p-8 relative">
  {%- if section.settings.background_image -%}
    <div class="absolute inset-0 z-0">
      {{ section.settings.background_image | image_url: width: 2000 | image_tag: class: 'w-full h-full object-cover' }}
      <div class="absolute inset-0 bg-black/40"></div>
    </div>
  {%- endif -%}

  <div class="relative z-10 max-w-lg {% if section.settings.background_image %}text-white{% endif %}">
    {%- comment -%} Logo {%- endcomment -%}
    {%- if section.settings.logo -%}
      {{ section.settings.logo | image_url: width: 300 | image_tag: class: 'h-12 w-auto mx-auto mb-12' }}
    {%- else -%}
      <h1 class="text-3xl font-black tracking-[0.2em] uppercase mb-12">{{ shop.name }}</h1>
    {%- endif -%}

    {%- comment -%} Heading {%- endcomment -%}
    {% if section.settings.heading != blank %}
      <h2 class="text-4xl font-light uppercase tracking-tight mb-6">{{ section.settings.heading }}</h2>
    {% endif %}

    {%- comment -%} Message {%- endcomment -%}
    {% if section.settings.message != blank %}
      <div class="prose {% if section.settings.background_image %}prose-invert{% else %}prose-stone{% endif %} mb-8 mx-auto">
        {{ section.settings.message }}
      </div>
    {% endif %}

    {%- comment -%} Newsletter {%- endcomment -%}
    {%- if section.settings.show_newsletter -%}
      {%- form 'customer', class: 'mb-8' -%}
        <input type="hidden" name="contact[tags]" value="newsletter,password-page">
        <div class="flex flex-col sm:flex-row gap-4">
          <input
            type="email"
            name="contact[email]"
            placeholder="{{ section.settings.newsletter_placeholder }}"
            required
            class="flex-1 px-6 py-4 {% if section.settings.background_image %}bg-white/10 border-white/20 placeholder-white/60 text-white{% else %}bg-white border-stone-200{% endif %} border text-sm focus:outline-none focus:ring-2 focus:ring-white"
          >
          <button type="submit" class="px-8 py-4 {% if section.settings.background_image %}bg-white text-stone-900{% else %}bg-stone-900 text-white{% endif %} text-[10px] uppercase tracking-widest font-bold hover:opacity-80 transition-opacity">
            {{ section.settings.newsletter_button }}
          </button>
        </div>
        {%- if form.posted_successfully? -%}
          <p class="text-sm mt-4 text-green-400">{{ section.settings.newsletter_success }}</p>
        {%- endif -%}
      {%- endform -%}
    {%- endif -%}

    {%- comment -%} Social Links {%- endcomment -%}
    {%- if section.settings.show_social -%}
      <div class="flex justify-center gap-6 mb-12">
        {%- if settings.social_instagram_link -%}
          <a href="{{ settings.social_instagram_link }}" target="_blank" rel="noopener" aria-label="Instagram" class="{% if section.settings.background_image %}text-white/60 hover:text-white{% else %}text-stone-400 hover:text-stone-900{% endif %} transition-colors">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>
          </a>
        {%- endif -%}
        {%- if settings.social_facebook_link -%}
          <a href="{{ settings.social_facebook_link }}" target="_blank" rel="noopener" aria-label="Facebook" class="{% if section.settings.background_image %}text-white/60 hover:text-white{% else %}text-stone-400 hover:text-stone-900{% endif %} transition-colors">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg>
          </a>
        {%- endif -%}
        {%- if settings.social_twitter_link -%}
          <a href="{{ settings.social_twitter_link }}" target="_blank" rel="noopener" aria-label="X / Twitter" class="{% if section.settings.background_image %}text-white/60 hover:text-white{% else %}text-stone-400 hover:text-stone-900{% endif %} transition-colors">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"/></svg>
          </a>
        {%- endif -%}
      </div>
    {%- endif -%}

    {%- comment -%} Enter Password Link {%- endcomment -%}
    <button type="button" class="text-[10px] uppercase tracking-widest {% if section.settings.background_image %}text-white/60 hover:text-white{% else %}text-stone-400 hover:text-stone-900{% endif %} transition-colors" onclick="document.getElementById('password-modal').classList.add('is-active')">
      {{ section.settings.password_link_text }}
    </button>
  </div>
</div>

{%- comment -%} Password Modal {%- endcomment -%}
<div id="password-modal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity [&.is-active]:opacity-100 [&.is-active]:pointer-events-auto">
  <div class="bg-white p-8 w-full max-w-md">
    <h3 class="text-xl font-medium mb-6">{{ section.settings.modal_heading }}</h3>
    {%- form 'storefront_password' -%}
      {%- if form.errors -%}
        <p class="text-sm text-red-500 mb-4">{{ form.errors.messages['form'] }}</p>
      {%- endif -%}
      <input type="password" name="password" placeholder="{{ section.settings.modal_placeholder }}" class="w-full px-4 py-3 border border-stone-200 mb-4 focus:outline-none focus:ring-2 focus:ring-stone-900">
      <div class="flex gap-4">
        <button type="submit" class="flex-1 py-4 bg-stone-900 text-white text-[10px] uppercase tracking-widest font-bold hover:bg-stone-800 transition-colors">
          {{ section.settings.modal_submit }}
        </button>
        <button type="button" class="px-6 py-4 border border-stone-200 text-[10px] uppercase tracking-widest font-bold hover:bg-stone-100 transition-colors" onclick="document.getElementById('password-modal').classList.remove('is-active')">
          {{ section.settings.modal_cancel }}
        </button>
      </div>
    {%- endform -%}
  </div>
</div>

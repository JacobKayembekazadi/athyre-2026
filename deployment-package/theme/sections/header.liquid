{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image"
    },
    {
      "type": "range",
      "id": "logo_width",
      "label": "Logo max width",
      "min": 50,
      "max": 400,
      "step": 10,
      "default": 150,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "logo_max_height",
      "label": "Logo max height",
      "min": 20,
      "max": 120,
      "step": 4,
      "default": 60,
      "unit": "px"
    },
    {
      "type": "text",
      "id": "logo_text",
      "label": "Logo text (if no image)",
      "default": "Athyre"
    },
    {
      "type": "text",
      "id": "tagline",
      "label": "Tagline (below logo)",
      "default": "Spirit \u2022 Soul \u2022 Body",
      "info": "Leave blank to hide"
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Main Menu",
      "default": "main-menu"
    },
    {
      "type": "range",
      "id": "left_nav_count",
      "label": "Menu items on left side",
      "min": 1,
      "max": 6,
      "step": 1,
      "default": 3,
      "info": "Remaining items appear on the right side of the logo"
    },
    {
      "type": "header",
      "content": "Behavior"
    },
    {
      "type": "checkbox",
      "id": "sticky",
      "label": "Sticky header",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "transparent_home",
      "label": "Transparent on homepage",
      "default": false
    },
    {
      "type": "header",
      "content": "Icons"
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "Show search icon",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_account",
      "label": "Show account icon",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_wishlist",
      "label": "Show wishlist icon",
      "default": false
    },
    {
      "type": "url",
      "id": "wishlist_url",
      "label": "Wishlist page link",
      "info": "Link to your wishlist page"
    },
    {
      "type": "header",
      "content": "Announcement Bar"
    },
    {
      "type": "checkbox",
      "id": "show_announcement",
      "label": "Show announcement bar",
      "default": false
    },
    {
      "type": "text",
      "id": "announcement_text",
      "label": "Announcement text",
      "default": "Free shipping on orders over $100"
    },
    {
      "type": "url",
      "id": "announcement_link",
      "label": "Announcement link"
    },
    {
      "type": "color",
      "id": "announcement_bg",
      "label": "Announcement background",
      "default": "#1c1917"
    },
    {
      "type": "color",
      "id": "announcement_text_color",
      "label": "Announcement text color",
      "default": "#ffffff"
    }
  ],
  "presets": [
    {
      "name": "Header"
    }
  ]
}
{% endschema %}


{% comment %} ANNOUNCEMENT BAR {% endcomment %}
{% if section.settings.show_announcement and section.settings.announcement_text != blank %}
  <div class="text-center py-2" style="background-color: {{ section.settings.announcement_bg }}; color: {{ section.settings.announcement_text_color }};">
    {% if section.settings.announcement_link != blank %}
      <a href="{{ section.settings.announcement_link }}" class="text-[10px] uppercase tracking-[0.2em] hover:opacity-80 transition-opacity" style="color: {{ section.settings.announcement_text_color }};">
        {{ section.settings.announcement_text }}
      </a>
    {% else %}
      <p class="text-[10px] uppercase tracking-[0.2em] m-0">{{ section.settings.announcement_text }}</p>
    {% endif %}
  </div>
{% endif %}

<header
  class="fixed w-full z-50 transition-all duration-300 {% if section.settings.sticky %}border-b border-stone-100 bg-white/95 backdrop-blur-sm shadow-sm py-3 md:py-4{% else %}bg-transparent py-4 md:py-6{% endif %}{% if section.settings.transparent_home and request.page_type == 'index' %} header--transparent{% endif %}"
  x-data="{ mobileMenuOpen: false }"
>
  <div class="max-w-7xl mx-auto px-4 md:px-8 items-center" style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 1rem; align-items: center;">

    {% comment %} LEFT: Mobile menu trigger + Desktop nav {% endcomment %}
    <div class="flex items-center">
      <button class="sm:hidden" @click="mobileMenuOpen = true" aria-label="{{ 'accessibility.menu' | t }}">
        {% render 'icon-menu', class: 'w-6 h-6 cursor-pointer text-stone-900' %}
      </button>
      <nav class="hidden sm:flex items-center gap-8" aria-label="Main navigation">
        {% for link in linklists[section.settings.menu].links limit: section.settings.left_nav_count %}
          <a href="{{ link.url }}" class="text-[10px] tracking-[0.2em] font-bold uppercase transition-opacity hover:opacity-60">{{ link.title }}</a>
        {% endfor %}
      </nav>
    </div>

    {% comment %} LOGO (Center) {% endcomment %}
    <a href="{{ routes.root_url }}" class="text-center group">
      {%- assign logo_heading_tag = 'h1' -%}
      {%- if request.page_type != 'index' -%}
        {%- assign logo_heading_tag = 'div' -%}
      {%- endif -%}
      <{{ logo_heading_tag }} class="text-2xl font-black tracking-[0.2em] uppercase m-0 leading-none flex items-center justify-center">
        {% if section.settings.logo %}
          {%- assign logo_width_2x = section.settings.logo_width | times: 2 -%}
          <img
            src="{{ section.settings.logo | image_url: width: logo_width_2x }}"
            alt="{{ shop.name }}"
            loading="eager"
            style="width: auto; height: auto; max-width: {{ section.settings.logo_width }}px; max-height: {{ section.settings.logo_max_height }}px; object-fit: contain;"
          >
        {% else %}
          {{ section.settings.logo_text }}
        {% endif %}
      </{{ logo_heading_tag }}>
      {% if section.settings.tagline != blank %}
        <span class="text-[8px] tracking-[0.6em] uppercase opacity-60 mt-1 block group-hover:opacity-100 transition-opacity">{{ section.settings.tagline }}</span>
      {% endif %}
    </a>

    {% comment %} RIGHT NAV (Icons) {% endcomment %}
    <div class="flex items-center gap-6" style="justify-self: end;">
      <nav class="hidden sm:flex items-center gap-8 mr-8">
        {% for link in linklists[section.settings.menu].links offset: section.settings.left_nav_count %}
          <a href="{{ link.url }}" class="text-[10px] tracking-[0.2em] font-bold uppercase transition-opacity hover:opacity-60">{{ link.title }}</a>
        {% endfor %}
      </nav>

      {% if section.settings.show_search %}
        <a href="{{ routes.search_url }}" aria-label="{{ 'general.search.search' | t }}">
          {% render 'icon-search', class: 'w-4 h-4 cursor-pointer hidden sm:block' %}
        </a>
      {% endif %}

      {% if section.settings.show_account %}
        <a href="{{ routes.account_url }}" aria-label="{{ 'customer.account.title' | t }}">
          {% render 'icon-user', class: 'w-4 h-4 cursor-pointer hidden sm:block' %}
        </a>
      {% endif %}

      {% if section.settings.show_wishlist and section.settings.wishlist_url != blank %}
        <a href="{{ section.settings.wishlist_url }}" aria-label="Wishlist">
          {% render 'icon-heart', class: 'w-4 h-4 cursor-pointer hidden sm:block' %}
        </a>
      {% endif %}

      <a href="{{ routes.cart_url }}" class="relative" aria-label="{{ 'cart.general.title' | t }} ({{ cart.item_count }})" data-cart-drawer-toggle>
        {% render 'icon-shopping-bag', class: 'w-4 h-4 cursor-pointer' %}
        {% if cart.item_count > 0 %}
          <span class="absolute -top-2 -right-2 bg-stone-900 text-white text-[8px] w-4 h-4 rounded-full flex items-center justify-center" data-cart-count>{{ cart.item_count }}</span>
        {% endif %}
      </a>
    </div>
  </div>

  {% comment %} MOBILE MENU OVERLAY {% endcomment %}
  <div
    x-show="mobileMenuOpen"
    x-cloak
    class="fixed inset-0 bg-white z-[60] flex flex-col justify-center items-center text-center"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0 -translate-x-full"
    x-transition:enter-end="opacity-100 translate-x-0"
    x-transition:leave="transition ease-in duration-200"
    x-transition:leave-start="opacity-100 translate-x-0"
    x-transition:leave-end="opacity-0 -translate-x-full"
    @keydown.escape.window="mobileMenuOpen = false"
  >
    <button @click="mobileMenuOpen = false" class="absolute top-8 right-8" aria-label="{{ 'accessibility.close' | t }}">
      {% render 'icon-close', class: 'w-8 h-8' %}
    </button>
    <nav class="flex flex-col gap-8" aria-label="Mobile navigation">
      {% for link in linklists[section.settings.menu].links %}
        <a href="{{ link.url }}" class="text-2xl font-light tracking-[0.2em] uppercase" @click="mobileMenuOpen = false">{{ link.title }}</a>
      {% endfor %}
    </nav>
  </div>
</header>

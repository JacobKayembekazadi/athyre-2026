{%- comment -%}
  Predictive Search Snippet
  Include this in header.liquid or wherever search is needed
{%- endcomment -%}

<div class="predictive-search relative" data-predictive-search>
  <form action="{{ routes.search_url }}" method="get" role="search" class="relative">
    <label for="predictive-search-input" class="visually-hidden">
      {{ 'general.search.search' | t | default: 'Search' }}
    </label>
    
    <input 
      type="search"
      id="predictive-search-input"
      name="q"
      class="w-full pl-10 pr-4 py-3 bg-stone-50 border border-stone-200 text-sm placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-stone-900 focus:border-transparent transition-all"
      placeholder="{{ 'general.search.placeholder' | t | default: 'Search products...' }}"
      autocomplete="off"
      autocorrect="off"
      autocapitalize="off"
      spellcheck="false"
      data-predictive-search-input
      aria-autocomplete="list"
      aria-controls="predictive-search-results"
      aria-haspopup="listbox"
    >
    
    {%- comment -%} Search icon {%- endcomment -%}
    <div class="absolute left-3 top-1/2 -translate-y-1/2 text-stone-400 pointer-events-none">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"/>
        <path d="M21 21l-4.35-4.35"/>
      </svg>
    </div>
    
    {%- comment -%} Loading indicator {%- endcomment -%}
    <div class="absolute right-3 top-1/2 -translate-y-1/2" data-predictive-search-loading style="display: none;">
      <svg class="animate-spin w-5 h-5 text-stone-400" viewBox="0 0 24 24" fill="none">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"/>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"/>
      </svg>
    </div>
    
    <input type="hidden" name="type" value="product,article,page">
  </form>
  
  {%- comment -%} Results dropdown {%- endcomment -%}
  <div 
    id="predictive-search-results"
    class="absolute top-full left-0 right-0 bg-white shadow-xl border border-stone-100 z-50 max-h-[70vh] overflow-y-auto"
    data-predictive-search-results
    aria-hidden="true"
    role="listbox"
    style="display: none;"
  >
    {%- comment -%} Results injected via JavaScript {%- endcomment -%}
  </div>
</div>

<script src="{{ 'predictive-search.js' | asset_url }}" defer></script>
